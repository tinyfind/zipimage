(function(i,r){typeof exports=="object"&&typeof module<"u"?module.exports=r():typeof define=="function"&&define.amd?define(r):(i=typeof globalThis<"u"?globalThis:i||self,i.zipimage=r())})(this,function(){"use strict";async function i(e,t=1){const n=f(e),o=await g(n,t,r(e.type));b(n);const s=m(o),c=d(s),a=p(c);return e.size>a.size?new File([a],e.name,{type:e.type}):e}function r(e){return e=="image/png"?"image/webp":"image/jpeg"}function m(e){const[t,n]=e.split(",");return window.atob(n)}function d(e){return new Uint8Array(Array.from(e).map(t=>t.charCodeAt(0)))}function p(e){return new Blob([e])}function b(e){window.URL.revokeObjectURL(e)}function f(e){return window.URL.createObjectURL(e)}async function g(e,t=1,n){const o=document.createElement("canvas"),s=o.getContext("2d"),c=await w(e),{width:a,height:u}=c;o.width=a,o.height=u,s.drawImage(c,0,0,a,u);try{return o.toDataURL(n,t)}finally{o.remove()}}function w(e){return new Promise(t=>{const n=document.createElement("img");n.src=e,n.onload=()=>{t(n),n.remove()}})}return i});
